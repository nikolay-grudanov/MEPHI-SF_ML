# Домашняя работа № 1

Выполнил: Груданов Николай Алексеевич

---

> Я использую Manjaro Linux на личном ПК, поэтому все задания будт выполнены на нем и скриншоты на нем. 
> У меня нет личного устройсва с ОС Windows.

## VirtualBox

### Включить аппаратную виртуализацию на компьютере/ноутбуке (если отключена).

На linux дистрибутивах за аппарутную виртуализацию отвечает KVM ([Kernel-based Virtual Machine](https://ru.wikipedia.org/wiki/KVM)). 

Для провеки выплним команду:

```bash

lsmod | grep kvm

```

И посмотрим на ее вывод

![alt text](image.png)

Данный вывод показывает состояние загруженных модулей ядра, связанных с аппаратной виртуализацией:

1. **kvm_amd (237568)**  
   - Драйвер для поддержки аппаратной виртуализации на процессорах AMD (SVM — Secure Virtual Machine).  
   - Размер модуля: 237568 байт.  
   - Используется 0 раз (последний ноль: нет активных зависимостей).

2. **kvm (1388544)**  
   - Основной модуль KVM (Kernel-based Virtual Machine).  
   - Размер: 1.38 МБ.  
   - Зависит от `kvm_amd` (цифра 1 в последнем столбце).

3. **ccp (184320)**  
   - Модуль **Crypto Co-Processor** — отвечает за работу с криптографическим сопроцессором AMD.  
   - Связан с `kvm_amd` (цифра 1 в последнем столбце).

---

Таким образом мы убедились, что загружены модули `kvm_amd` и `kvm`, что указывает на корректную работу KVM для моего процессора AMD. Значит аппаратная виртуализация активна.

### Скачать и установить VirtualBox версии 6.1 и выше

Для начала установим нужные заивсимти. Я испльзую менеждер пакетов `yay`. Поэтому команда будет выглядеть следующим образом.

![alt text](image-1.png)

После установим сам VirtualBox. 

![alt text](image-5.png)

Таже установим доплнительный пакет для гостевых ОС 

![alt text](image-4.png)

### Скачать и установить плагин VirtualBox Extension Pack: в отчете отобразить список функций, которые предоставляет Extension Pack.

Для установки выполним следющею команду:

![alt text](image-2.png)

После согласимся с установкой и укажем пароль для sudo. 

После установки проверим что версии VirtualBox и VirtualBox Extension Pack совпадают. Это важно для корректной работы. 

![alt text](image-3.png)

Видим, что версии сопадают. У обоих 7.1.6.

**Список функций, которые предоставляет Extension Pack**


1. **Поддержка USB 2.0/3.0**  
   Позволяет подключать физические USB-устройства (флешки, принтеры) внутри виртуальных машин.

2. **VirtualBox RDP (Remote Desktop Protocol)**  
   Удалённое управление виртуальными машинами через протокол RDP.

3. **Шифрование дисков**  
   Защита данных виртуальных HDD с помощью AES-256. Пример использования:  

4. **PXE Boot для Intel**  
   Сетевая загрузка виртуальных машин через эмуляцию PXE ROM.

5. **Общий доступ к веб-камере хоста**  
   Использование камеры физического устройства в гостевой ОС без драйверов.

**Дополнительные возможности**

- **NVMe-хранилище**  
  Эмуляция современных SSD для повышения производительности.
- **Виртуальное USB-устройство xHCI**  
  Поддержка USB 3.0 в гостевых ОС.
- **Cloud Integration**  
  Автоматическая интеграция с облачными сервисами через VRDE.
- **Шифрование VMCI**  
  Защита межмашинного взаимодействия.

Источники:  

- [Официальная документация](https://www.virtualbox.org/manual/ch01.html#intro-installing)  
- [Oracle VM VirtualBox Documentation](https://documentation.help/VirtualBox/ch08s41.html)

### Скачать десктопную версию Ubuntu 22.04 LTS (Jammy Jellyfish)

Скачать десктопную версию Ubuntu 22.04 LTS (Jammy Jellyfish), создать виртуальную машину со
следующими параметрами:

- 2 CPU.
- 2048 RAM.
- 128 МБ видеопамяти.
- 40 GB постоянной памяти (динамический VDI)
- Сетевой адаптер установить в режим NAT

Для скачивания перходим на оффицальный сайт [ubuntu](https://releases.ubuntu.mirror.onlime.sl/jammy/)

![alt text](image-6.png)

Я выбраз загрузку через торрент для большей скорости

![alt text](image-7.png)

Полсле ждем загружки

![alt text](image-8.png)

Теперь можно приступать к созданию витруальной машины в VirtualBox.

![alt text](image-9.png)

Нажимаем кнопку создать и даем название нашей машине и указываем путь до ISO обрза.
Прожимаем "Пропустить автоматическую установку" чтоб самим следовать по шагам установщика.

![alt text](image-10.png)

Далее указываем ресурсы для нашей виртуальной машине, согласно зданию

![alt text](image-11.png)

![alt text](image-12.png)

Наша виртуальная машина создалась.

При создании не было возможности указать количество видео памяти, поэтому зададим ее сейчас. 

![alt text](image-42.png)

И NAT

![alt text](image-41.png)

### Произвести установку ОС Ubuntu 22.04 LTS на виртуальную машину, следуя указаниям установщика

Для установки надо запустить виртуальную машину.

![alt text](image-13.png)

После запуска видим варианты запуска. Для установки выбираем первый пункт.

![alt text](image-14.png)

Видим графический установщик.

![alt text](image-15.png)

Далее идет по шагам которые предлагает графический утановщик Ubuntu.

Полсе всех шагов видим окно с информацией о завершении установки. 

![alt text](image-16.png)

Перезагружаем систему. После видим выбор пользователя для входы. Выбираем нашего пользователя и вводим пароль.

![alt text](image-17.png)

Пропускаем все приветвенные окна и видим, что все готово к работе. 

![alt text](image-18.png)

### Создать снимок виртуальной машины, назвать снимок именем «Ubuntu-clear»

Выключаем виртуальную машину. Полсе нажимаем на 3 черточки и выбираем раздел для создания сномков. 

![alt text](image-19.png)

Открывается следующее меню

![alt text](image-20.png)

Нажимаем кнопку "Сделать". Указываем имя и описвание снимка.

![alt text](image-21.png)

Видим созданый снимок.

![alt text](image-22.png)


### Произвести установку гостевых дополнений и перезагрузить виртуальную машину

Первым делом обновим все пакеты. 

![alt text](image-23.png)

![alt text](image-24.png)

Обновим систему.

![alt text](image-25.png)

![alt text](image-26.png)

Теперь установим зависимомти.


Для установки зависимостей гостевых дополнений VirtualBox в Ubuntu выполним

```bash
sudo apt update && sudo apt install -y build-essential dkms linux-headers-$(uname -r) gcc make perl module-assistant
```
Пояснение пакетов:
- `build-essential` — компиляторы и инструменты сборки
- `dkms` — динамическое обновление модулей ядра
- `linux-headers-$(uname -r)` — заголовки текущей версии ядра
- `gcc`, `make`, `perl` — базовые инструменты компиляции
- `module-assistant` — упрощает сборку сторонних модулей

![alt text](image-28.png)

![alt text](image-29.png)

![alt text](image-30.png)

После нужна подготовка окружения (для Ubuntu 22.04+)

```bash
sudo m-a prepare
```

![alt text](image-31.png)

После нажимаем "Устройства" -> "Подключить образ Дополнительной гостевой ОС"

![alt text](image-32.png)

Видим что появился значек диска, то есть примонтировался диск с гостевыми дополнениями 

![alt text](image-33.png)

Автоматическая установка не произошла, поэтому надо запустить установку вручную. Для этого надо перейти в смонтированый диск и найти скрипт для запуска установки.

![alt text](image-34.png)

Запускаем нужный скрипт

![alt text](image-36.png)

После зпуска видим сообще о успешной установке.

![alt text](image-37.png)

Перезагружаем виртуальную машину

![alt text](image-38.png)

После перезапуска получается растянуть виртуальную машину на весь экран, что говорит об успешной установке и корректной работе.

![alt text](image-43.png)

Источники:
- <https://bafista.ru/virtualbox-install-guest-additation-linux-ubuntu/>
- <https://blog.programs74.ru/how-to-install-virtualbox-guest-additions-on-ubuntu-2204/>
- <https://losst.pro/ustanovka-dopolnenij-gostevoj-os-ubuntu>

### Создать снимок виртуальной машины, назвать снимок именем «Ubuntu-guest-additions»

![alt text](image-44.png)

![alt text](image-45.png)

### Произвести настройку операционной системы в соответствии с личными предпочтениями (сменить обои, установить браузер и т.д)

Произвел кастомизацию. Установил:

* tmux
* neovim
* alacritty
* Яндекс браузер

Поменял фон и тему оформления

![alt text](image-46.png)

### Создать снимок виртуальной машины, назвать снимок именем «Ubuntu-customized»

![alt text](image-47.png)

![alt text](image-48.png)

### Произвести экспорт виртуальной машины в формате OVA.

В главном меню VirtualBox выбераем Файл 

![alt text](image-49.png)

Далее Экспорт конфигураций

![alt text](image-50.png)

Выбераем нашу виртуальную машину

![alt text](image-51.png) 

Видим процесс экспорта

![alt text](image-52.png)

После выполнения можем найти файл в директории 

![alt text](image-53.png)

## Vagrant

Скачиваем образ по ссылке из задания

![alt text](image-54.png)

Приозводим инициализацию образа ubuntu/jammy64

![alt text](image-55.png)

Запустить виртуальную машину

![alt text](image-56.png)

![alt text](image-57.png)

Удаляем машину

![alt text](image-58.png)

C помощью текстового редактора nvim внесём изменения в VagrantFile

![alt text](image-59.png)

![alt text](image-60.png)

Производим запуск машины

![alt text](image-61.png)

![alt text](image-62.png)

Проверяем что машина создалась коректно с нужными параметрами

![alt text](image-63.png)

Видим новуж виртупльную машину с 048 МБ ОЗУ и 2 VPCU и именеи ubuntu.

Произведем создание снимока виртуальной машины

![alt text](image-64.png)

![alt text](image-65.png)

![alt text](image-66.png)

Подключимся к машине по ssh

![alt text](image-67.png)

![alt text](image-68.png)

Обновим пакеты

![alt text](image-70.png)

Запустился процесс обновления

![alt text](image-71.png)

Видим что все успешно обновилось

![alt text](image-72.png)

Выйдем с помошью команды `exit`

![alt text](image-73.png)

Остановим виртуальную машину

![alt text](image-74.png)

![alt text](image-75.png)

Процесс упаковки виртуальной машины в образ с именем "ubuntu2204.box"

![alt text](image-76.png)

![alt text](image-77.png)

Проверим что наш образ есть в списке доступных образов

![alt text](image-78.png)

Он есть, перейдем к следуюшему шагу, загрузим образ в локальный репозиторий

![alt text](image-79.png)

![alt text](image-80.png)

![alt text](image-81.png)

Инициализация и запуск новой машины, для этого создадим новую папку

![alt text](image-82.png)

Инициализируем Vagrantfile в новой папке с помощью команды `vagrant init ubuntu2204`

![alt text](image-83.png)

Запустим машину

![alt text](image-84.png)

![alt text](image-85.png)

Создание снимка

![alt text](image-86.png)

Внесем изменения в ВМ

![alt text](image-87.png)

![alt text](image-88.png)

![alt text](image-89.png)

Добавили файл test_file.txt

Теперь востановим машину из снепшота и проверим, что нет ранее созданого файла

![alt text](image-90.png)

![alt text](image-91.png)

![alt text](image-92.png)
