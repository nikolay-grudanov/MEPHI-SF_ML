# Инструкция по выполнению домашнего задания №3 по Linux

## Введение

Данная инструкция поможет вам выполнить домашнее задание по управлению пользователями, группами и правами доступа в Linux. Все команды должны выполняться от имени обычного пользователя (не root), кроме тех случаев, где прямо указано использование sudo.

## Подготовка к выполнению

### 1. Запуск записи сеанса
Перед началом выполнения заданий запустите команду для записи сеанса:
```bash
script typescript.txt
```
Эта команда будет записывать все ваши действия в файл `typescript.txt`.

**Важно:** Не забудьте выполнить команду `exit` в конце работы для завершения записи!

## Часть 1: Управление пользователями и группами

### Задание 1: Переход в домашний каталог
```bash
cd ~
```
или
```bash
cd
```
Команда `cd` без параметров всегда переводит в домашний каталог текущего пользователя.

### Задание 2: Определение бюджета пользователя vagrant
```bash
cat /etc/passwd | grep vagrant
```
или
```bash
grep vagrant /etc/passwd
```

**Объяснение:** Файл `/etc/passwd` содержит информацию о всех пользователях системы в формате:
`имя:пароль:UID:GID:GECOS:домашний_каталог:оболочка`

### Задание 3: Определение минимального возраста пароля
```bash
sudo cat /etc/shadow | grep vagrant
```

**Объяснение:** Файл `/etc/shadow` содержит зашифрованные пароли и информацию об устаревании паролей. Четвертое поле после имени пользователя показывает минимальный возраст пароля в днях.

### Задание 4: Дата последнего изменения пароля
```bash
sudo passwd -S vagrant
```
или
```bash
sudo chage -l vagrant
```

**Объяснение:** Команда `passwd -S` показывает статус пароля пользователя, включая дату последнего изменения.

### Задание 5: Создание пользователя user01
```bash
sudo useradd -d /home/user01 -s /bin/sh -g user01 -e 2026-12-13 -m user01
```

**Разбор параметров:**
- `-d /home/user01` - домашняя директория
- `-s /bin/sh` - оболочка
- `-g user01` - первичная группа (создается автоматически)
- `-e 2026-12-13` - срок действия учетной записи
- `-m` - создать домашний каталог
- `user01` - имя пользователя

### Задание 6: Установка пароля пользователю user01
```bash
sudo passwd user01
```
Система запросит новый пароль (введите дважды для подтверждения).

### Задание 7: Вход под учетной записью user01
```bash
su user01
```
Введите пароль, который вы установили на предыдущем шаге.

### Задание 8: Проверка текущего пользователя
```bash
whoami
```
Команда должна показать `user01`.

### Задание 9: Переход в домашний каталог и проверка содержимого
```bash
cd ~
pwd
ls -la
```

### Задание 10: Установка информации о пользователе
```bash
chfn
```
Команда запросит ввод полного имени, номера комнаты, рабочего и домашнего телефонов.

### Задание 11: Просмотр информации о пользователе
```bash
finger user01
```

**Примечание:** Если команда `finger` не установлена, установите ее:
```bash
sudo apt install finger  # для Ubuntu/Debian
```

### Задание 12: Выход из сеанса user01
```bash
exit
```

### Задание 13: Добавление user01 в группу sudo
```bash
sudo usermod -a -G sudo user01
```

**Объяснение:**
- `-a` - добавить к существующим группам (не заменять)
- `-G sudo` - добавить в группу sudo

### Задание 14: Повторный вход от имени user01
```bash
su user01
```

### Задание 15: Проверка прав sudo
```bash
sudo whoami
```
Должно вывести `root`, если права sudo предоставлены корректно.

### Задание 16: Создание группы group01
```bash
sudo groupadd group01
```

### Задание 17: Добавление пользователей в группу group01
```bash
sudo usermod -a -G group01 user01
sudo usermod -a -G group01 vagrant
```

### Задание 18: Проверка членов группы
```bash
sudo groupmems -g group01 -l
```

### Задание 19: Выход из сеанса user01
```bash
exit
```

## Часть 2: Управление доступом к файлам и каталогам

### Задание 1: Переход в домашний каталог
```bash
cd ~
```

### Задание 2: Создание каталога test
```bash
mkdir test
cd test
```

### Задание 3: Создание файла и проверка прав
```bash
touch file
ls -l file
```
Права по умолчанию обычно: `-rw-rw-r--`

### Задание 4: Запрет всех действий с файлом
```bash
chmod 000 file
```
или
```bash
chmod ---------- file
```

### Задание 5: Попытка записи в файл
```bash
echo "тест" > file
```
Должна выдать ошибку "Permission denied".

### Задание 6: Попытка чтения файла
```bash
cat file
```
Должна выдать ошибку "Permission denied".

### Задание 7: Установка прав только на запись для владельца
```bash
chmod 200 file
```
или
```bash
chmod -w------- file
```
Проверьте: `ls -l file` должно показать `--w-------`

### Задание 8: Запись в файл и попытка чтения
```bash
echo "test" > file
cat file
```
Запись должна пройти успешно, чтение - выдать ошибку.

### Задание 9: Разрешение чтения для группы
```bash
chmod 240 file
```
или
```bash
chmod --w-r----- file
```
Проверьте: `ls -l file` должно показать `--w-r-----`

### Задание 10: Попытка чтения файла
```bash
cat file
```
Все еще должна выдать ошибку, так как у владельца нет права чтения.

### Задание 11: Разрешение чтения владельцу
```bash
chmod 640 file
```
или
```bash
chmod -rw-r----- file
```
Проверьте: `ls -l file` должно показать `-rw-r-----`

### Задание 12: Чтение содержимого файла
```bash
cat file
```
Должно вывести ранее записанное "test".

### Задание 13: Создание каталога и файла в нем
```bash
mkdir dir
echo "file 2" > dir/new_file
```

### Задание 14: Просмотр содержимого каталога
```bash
ls -l dir
```

### Задание 15: Изменение прав каталога
```bash
chmod -x dir
cat dir/new_file
rm dir/new_file
```
Обе операции должны выдать ошибку "Permission denied".

### Задание 16: Попытка изменения владельца
```bash
chown root file
chgrp root file
```
Обе команды должны выдать ошибку, так как обычный пользователь не может изменить владельца.

### Задание 17: Установка umask для создания приватных файлов
```bash
umask 077
touch file1
ls -l file1
```
Права должны быть `-rw-------`

### Задание 18: Установка umask для полного доступа
```bash
umask 000
touch file2
ls -l file2
```
Права должны быть `-rw-rw-rw-`

### Задание 19: Вход как root
```bash
sudo su
```

### Задание 20: Изменение владельца от имени root
```bash
chown root file
chmod 400 file
exit
```

### Задание 21: Попытка чтения файла обычным пользователем
```bash
cat file
```
Должна выдать ошибку "Permission denied".

### Задание 22: Предоставление прав группе от имени root
```bash
sudo su
chmod 440 file
exit
```

### Задание 23: Чтение файла обычным пользователем
```bash
cat file
```
Доступ должен быть разрешен, если пользователь входит в ту же группу.

## Создание итогового файла dz3.txt

После выполнения всех заданий создайте итоговый файл:
```bash
cat /etc/passwd >> dz3.txt
cat /etc/group >> dz3.txt
```

## Завершение работы

Завершите запись сеанса:
```bash
exit
```

## Важные замечания

1. **Безопасность:** Никогда не работайте под root без необходимости
2. **Права доступа:** Всегда проверяйте права после их изменения с помощью `ls -l`
3. **Бэкапы:** В реальной работе всегда делайте резервные копии важных файлов
4. **Документирование:** Записывайте все изменения для возможности отката

## Полезные команды для проверки

- `id` - показать UID, GID и группы текущего пользователя
- `groups` - показать группы пользователя
- `ls -l` - подробный список файлов с правами
- `whoami` - показать имя текущего пользователя
- `pwd` - показать текущий каталог

## Расшифровка прав доступа

Права доступа состоят из 10 символов:
1. Тип файла: `-` (файл), `d` (каталог), `l` (ссылка)
2-4. Права владельца: `r` (чтение), `w` (запись), `x` (выполнение)
5-7. Права группы: `r`, `w`, `x`
8-10. Права остальных: `r`, `w`, `x`

Цифровое представление:
- 4 = чтение (r)
- 2 = запись (w)  
- 1 = выполнение (x)
- 0 = нет прав

Например: 755 = rwxr-xr-x (владелец: все права, группа и остальные: чтение и выполнение)